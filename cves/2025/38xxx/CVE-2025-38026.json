{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-38026",
        "assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
        "state": "PUBLISHED",
        "assignerShortName": "Linux",
        "dateReserved": "2025-04-16T04:51:23.978Z",
        "datePublished": "2025-06-18T09:28:31.917Z",
        "dateUpdated": "2025-06-18T09:28:31.917Z"
    },
    "containers": {
        "cna": {
            "providerMetadata": {
                "orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
                "shortName": "Linux",
                "dateUpdated": "2025-06-18T09:28:31.917Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/sev: Do not touch VMSA pages during SNP guest memory kdump\n\nWhen kdump is running makedumpfile to generate vmcore and dump SNP guest\nmemory it touches the VMSA page of the vCPU executing kdump.\n\nIt then results in unrecoverable #NPF/RMP faults as the VMSA page is\nmarked busy/in-use when the vCPU is running and subsequently a causes\nguest softlockup/hang.\n\nAdditionally, other APs may be halted in guest mode and their VMSA pages\nare marked busy and touching these VMSA pages during guest memory dump\nwill also cause #NPF.\n\nIssue AP_DESTROY GHCB calls on other APs to ensure they are kicked out\nof guest mode and then clear the VMSA bit on their VMSA pages.\n\nIf the vCPU running kdump is an AP, mark it's VMSA page as offline to\nensure that makedumpfile excludes that page while dumping guest memory."
                }
            ],
            "affected": [
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "unaffected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/coco/sev/core.c"
                    ],
                    "versions": [
                        {
                            "version": "3074152e56c9b0f9b9c67edfbc08b371db050b6d",
                            "lessThan": "26468ea864fecf496654459e52a6b7a7230bcb6d",
                            "status": "affected",
                            "versionType": "git"
                        },
                        {
                            "version": "3074152e56c9b0f9b9c67edfbc08b371db050b6d",
                            "lessThan": "d2062cc1b1c367d5d019f595ef860159e1301351",
                            "status": "affected",
                            "versionType": "git"
                        }
                    ]
                },
                {
                    "product": "Linux",
                    "vendor": "Linux",
                    "defaultStatus": "affected",
                    "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
                    "programFiles": [
                        "arch/x86/coco/sev/core.c"
                    ],
                    "versions": [
                        {
                            "version": "6.13",
                            "status": "affected"
                        },
                        {
                            "version": "0",
                            "lessThan": "6.13",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.14.8",
                            "lessThanOrEqual": "6.14.*",
                            "status": "unaffected",
                            "versionType": "semver"
                        },
                        {
                            "version": "6.15",
                            "lessThanOrEqual": "*",
                            "status": "unaffected",
                            "versionType": "original_commit_for_fix"
                        }
                    ]
                }
            ],
            "cpeApplicability": [
                {
                    "nodes": [
                        {
                            "operator": "OR",
                            "negate": false,
                            "cpeMatch": [
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "6.13",
                                    "versionEndExcluding": "6.14.8"
                                },
                                {
                                    "vulnerable": true,
                                    "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                                    "versionStartIncluding": "6.13",
                                    "versionEndExcluding": "6.15"
                                }
                            ]
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://git.kernel.org/stable/c/26468ea864fecf496654459e52a6b7a7230bcb6d"
                },
                {
                    "url": "https://git.kernel.org/stable/c/d2062cc1b1c367d5d019f595ef860159e1301351"
                }
            ],
            "title": "x86/sev: Do not touch VMSA pages during SNP guest memory kdump",
            "x_generator": {
                "engine": "bippy-1.2.0"
            }
        }
    }
}