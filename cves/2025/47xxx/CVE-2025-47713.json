{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2025-47713",
        "assignerOrgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
        "state": "PUBLISHED",
        "assignerShortName": "apache",
        "dateReserved": "2025-05-07T22:41:41.858Z",
        "datePublished": "2025-06-10T23:06:45.585Z",
        "dateUpdated": "2025-06-10T23:06:45.585Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "product": "Apache CloudStack",
                    "vendor": "Apache Software Foundation",
                    "versions": [
                        {
                            "lessThan": "4.19.3.0",
                            "status": "affected",
                            "version": "4.10.0",
                            "versionType": "semver"
                        },
                        {
                            "lessThan": "4.20.1.0",
                            "status": "affected",
                            "version": "4.20.0.0",
                            "versionType": "semver"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Scott Schmitz <sschmitz@ussignal.com>"
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p></p><div><span style=\"background-color: rgba(232, 232, 232, 0.04);\">A privilege escalation vulnerability exists in Apache CloudStack versions 4.10.0.0 through 4.20.0.0 where a malicious Domain Admin user in the ROOT domain can reset the password of user-accounts of Admin role type. This operation is not appropriately restricted and allows the attacker to assume control over higher-privileged user-accounts.&nbsp;</span><span style=\"background-color: rgba(232, 232, 232, 0.04);\">A malicious Domain Admin attacker can impersonate an Admin user-account and gain access to sensitive APIs and resources that&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">could result in the compromise of resource integrity and confidentiality, data loss, denial of service, and availability of infrastructure managed by CloudStack.</span><br><br></span></div><div><span style=\"background-color: rgba(232, 232, 232, 0.04);\">Users are recommended to upgrade to Apache CloudStack 4.19.3.0 or 4.20.1.0, which fixes the issue with the following:<br></span><span style=\"background-color: rgba(232, 232, 232, 0.04);\"><div><ul><li><span style=\"background-color: rgba(232, 232, 232, 0.04);\"><span style=\"background-color: rgba(232, 232, 232, 0.04);\">Strict validation on Role Type hierarchy: the caller's user-account role must be equal to or higher than the target user-account's role.</span></span></li><li><span style=\"background-color: rgba(232, 232, 232, 0.04);\"><span style=\"background-color: rgba(232, 232, 232, 0.04);\">API privilege comparison: the caller must possess all privileges of the user they are operating on. </span></span></li><li><span style=\"background-color: rgba(232, 232, 232, 0.04);\"><span style=\"background-color: rgba(232, 232, 232, 0.04);\">Two new domain-level settings (restricted to the default Admin): <br> - role.types.allowed.for.operations.on.accounts.of.same.role.type: Defines which role types are allowed to act on users of the same role type. Default: \"Admin, DomainAdmin, ResourceAdmin\". <br>&nbsp; &nbsp;- allow.operations.on.users.in.same.account: Allows/disallows user operations within the same account. Default: true.</span></span></li></ul></div></span></div><p></p>"
                        }
                    ],
                    "value": "A privilege escalation vulnerability exists in Apache CloudStack versions 4.10.0.0 through 4.20.0.0 where a malicious Domain Admin user in the ROOT domain can reset the password of user-accounts of Admin role type. This operation is not appropriately restricted and allows the attacker to assume control over higher-privileged user-accounts. A malicious Domain Admin attacker can impersonate an Admin user-account and gain access to sensitive APIs and resources that could result in the compromise of resource integrity and confidentiality, data loss, denial of service, and availability of infrastructure managed by CloudStack.\n\n\n\nUsers are recommended to upgrade to Apache CloudStack 4.19.3.0 or 4.20.1.0, which fixes the issue with the following:\n  *  Strict validation on Role Type hierarchy: the caller's user-account role must be equal to or higher than the target user-account's role.\n  *  API privilege comparison: the caller must possess all privileges of the user they are operating on. \n  *  Two new domain-level settings (restricted to the default Admin): \n - role.types.allowed.for.operations.on.accounts.of.same.role.type: Defines which role types are allowed to act on users of the same role type. Default: \"Admin, DomainAdmin, ResourceAdmin\". \n   - allow.operations.on.users.in.same.account: Allows/disallows user operations within the same account. Default: true."
                }
            ],
            "metrics": [
                {
                    "other": {
                        "content": {
                            "text": "critical"
                        },
                        "type": "Textual description of severity"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-269",
                            "description": "CWE-269 Improper Privilege Management",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
                "shortName": "apache",
                "dateUpdated": "2025-06-10T23:06:45.585Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://cloudstack.apache.org/blog/cve-advisories-4.19.3.0-4.20.1.0/"
                },
                {
                    "tags": [
                        "third-party-advisory"
                    ],
                    "url": "https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-19-3-0-and-4-20-1-0/"
                },
                {
                    "tags": [
                        "mailing-list"
                    ],
                    "url": "https://lists.apache.org/thread/y3qnwn59t8qggtdohv7k7vw39bgb3d60"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "Apache CloudStack: Domain Admin can reset Admin password in Root Domain",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        }
    }
}