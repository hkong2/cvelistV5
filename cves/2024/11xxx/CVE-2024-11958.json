{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-11958",
        "assignerOrgId": "c09c270a-b464-47c1-9133-acb35b22c19a",
        "state": "PUBLISHED",
        "assignerShortName": "@huntr_ai",
        "dateReserved": "2024-11-28T08:42:59.358Z",
        "datePublished": "2025-03-20T10:10:46.492Z",
        "dateUpdated": "2025-03-20T10:10:46.492Z"
    },
    "containers": {
        "cna": {
            "title": "SQL Injection in run-llama/llama_index",
            "providerMetadata": {
                "orgId": "c09c270a-b464-47c1-9133-acb35b22c19a",
                "shortName": "@huntr_ai",
                "dateUpdated": "2025-03-20T10:10:46.492Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "A SQL injection vulnerability exists in the `duckdb_retriever` component of the run-llama/llama_index repository, specifically in the latest version. The vulnerability arises from the construction of SQL queries without using prepared statements, allowing an attacker to inject arbitrary SQL code. This can lead to remote code execution (RCE) by installing the shellfs extension and executing malicious commands."
                }
            ],
            "affected": [
                {
                    "vendor": "run-llama",
                    "product": "run-llama/llama_index",
                    "versions": [
                        {
                            "version": "unspecified",
                            "lessThan": "0.4.0",
                            "status": "affected",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://huntr.com/bounties/8ddf66e1-f74c-4d53-992b-76bc45cacac1"
                },
                {
                    "url": "https://github.com/run-llama/llama_index/commit/35bd221e948e40458052d30c6ef2779bc965b6d0"
                }
            ],
            "metrics": [
                {
                    "cvssV3_0": {
                        "version": "3.0",
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                        "baseScore": 9.8,
                        "baseSeverity": "CRITICAL"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "lang": "en",
                            "description": "CWE-89 Improper Neutralization of Special Elements used in an SQL Command",
                            "cweId": "CWE-89"
                        }
                    ]
                }
            ],
            "source": {
                "advisory": "8ddf66e1-f74c-4d53-992b-76bc45cacac1",
                "discovery": "EXTERNAL"
            }
        }
    }
}