{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.2",
    "cveMetadata": {
        "cveId": "CVE-2026-2415",
        "assignerOrgId": "655498c3-6ec5-4f0b-aea6-853b334d05a6",
        "state": "PUBLISHED",
        "assignerShortName": "rami.io",
        "dateReserved": "2026-02-12T17:02:46.966Z",
        "datePublished": "2026-02-16T10:15:09.149Z",
        "dateUpdated": "2026-02-16T10:15:09.149Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://pypi.org/",
                    "defaultStatus": "unaffected",
                    "packageName": "pretix",
                    "product": "pretix",
                    "repo": "https://github.com/pretix/pretix",
                    "vendor": "pretix",
                    "versions": [
                        {
                            "lessThan": "2025.9.0",
                            "status": "affected",
                            "version": "4.16.0",
                            "versionType": "python"
                        },
                        {
                            "changes": [
                                {
                                    "at": "2025.9.4",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "2025.10.0",
                            "status": "affected",
                            "version": "2025.9.0",
                            "versionType": "python"
                        },
                        {
                            "changes": [
                                {
                                    "at": "2025.10.2",
                                    "status": "unaffected"
                                }
                            ],
                            "lessThan": "2026.1.0",
                            "status": "affected",
                            "version": "2025.10.0",
                            "versionType": "python"
                        },
                        {
                            "lessThan": "2026.1.1",
                            "status": "affected",
                            "version": "2026.1.0",
                            "versionType": "python"
                        }
                    ]
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>Emails sent by pretix can utilize placeholders that will be filled with customer data. For example, when <code>{name}</code>\n is used in an email template, it will  be replaced with the buyer's \nname for the final email. This mechanism contained two security-relevant\n bugs:</p>\n<ol>\n<li>\n<p>It was possible to exfiltrate information about the pretix system through specially crafted placeholder names such as <code>{{event.__init__.__code__.co_filename}}</code>.\n This way, an attacker with the ability to control email templates \n(usually every user of the pretix backend) could retrieve sensitive \ninformation from the system configuration, including even database \npasswords or API keys. pretix does include mechanisms to prevent the usage of such \nmalicious placeholders, however due to a mistake in the code, they were \nnot fully effective for the email subject.</p>\n</li>\n<li>\n<p>Placeholders in subjects and plain text bodies of emails were \nwrongfully evaluated twice. Therefore, if the first evaluation of a \nplaceholder again contains a placeholder, this second placeholder was \nrendered. This allows the rendering of placeholders controlled by the \nticket buyer, and therefore the exploitation of the first issue as a \nticket buyer. Luckily, the only buyer-controlled placeholder available \nin pretix by default (that is not validated in a way that prevents the \nissue) is <code>{invoice_company}</code>, which is very unusual (but not\n impossible) to be contained in an email subject template. In addition \nto broadening the attack surface of the first issue, this could \ntheoretically also leak information about an order to one of the \nattendees within that order. However, we also consider this scenario \nvery unlikely under typical conditions.</p></li></ol><div>Out of caution, we recommend that you rotate all passwords and API keys contained in your <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.pretix.eu/self-hosting/config/\">pretix.cfg</a>&nbsp;file.<br></div>"
                        }
                    ],
                    "value": "Emails sent by pretix can utilize placeholders that will be filled with customer data. For example, when {name}\n is used in an email template, it will  be replaced with the buyer's \nname for the final email. This mechanism contained two security-relevant\n bugs:\n\n\n\n  *  \nIt was possible to exfiltrate information about the pretix system through specially crafted placeholder names such as {{event.__init__.__code__.co_filename}}.\n This way, an attacker with the ability to control email templates \n(usually every user of the pretix backend) could retrieve sensitive \ninformation from the system configuration, including even database \npasswords or API keys. pretix does include mechanisms to prevent the usage of such \nmalicious placeholders, however due to a mistake in the code, they were \nnot fully effective for the email subject.\n\n\n\n\n  *  \nPlaceholders in subjects and plain text bodies of emails were \nwrongfully evaluated twice. Therefore, if the first evaluation of a \nplaceholder again contains a placeholder, this second placeholder was \nrendered. This allows the rendering of placeholders controlled by the \nticket buyer, and therefore the exploitation of the first issue as a \nticket buyer. Luckily, the only buyer-controlled placeholder available \nin pretix by default (that is not validated in a way that prevents the \nissue) is {invoice_company}, which is very unusual (but not\n impossible) to be contained in an email subject template. In addition \nto broadening the attack surface of the first issue, this could \ntheoretically also leak information about an order to one of the \nattendees within that order. However, we also consider this scenario \nvery unlikely under typical conditions.\n\n\nOut of caution, we recommend that you rotate all passwords and API keys contained in your  pretix.cfg https://docs.pretix.eu/self-hosting/config/ Â file."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-545",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-545 Pull Data from System Resources"
                        }
                    ]
                },
                {
                    "capecId": "CAPEC-77",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-77 Manipulating User-Controlled Variables"
                        }
                    ]
                },
                {
                    "capecId": "CAPEC-54",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-54 Query System for Information"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "HIGH",
                        "attackRequirements": "NONE",
                        "attackVector": "NETWORK",
                        "baseScore": 7.5,
                        "baseSeverity": "HIGH",
                        "exploitMaturity": "PROOF_OF_CONCEPT",
                        "privilegesRequired": "LOW",
                        "providerUrgency": "RED",
                        "subAvailabilityImpact": "HIGH",
                        "subConfidentialityImpact": "HIGH",
                        "subIntegrityImpact": "HIGH",
                        "userInteraction": "NONE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/E:P/RE:L/U:Red",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "HIGH",
                        "vulnConfidentialityImpact": "HIGH",
                        "vulnIntegrityImpact": "HIGH",
                        "vulnerabilityResponseEffort": "LOW"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-627",
                            "description": "CWE-627 Dynamic Variable Evaluation",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "655498c3-6ec5-4f0b-aea6-853b334d05a6",
                "shortName": "rami.io",
                "dateUpdated": "2026-02-16T10:15:09.149Z"
            },
            "references": [
                {
                    "tags": [
                        "vendor-advisory"
                    ],
                    "url": "https://pretix.eu/about/en/blog/20260216-release-2026-1-1/"
                }
            ],
            "source": {
                "discovery": "INTERNAL"
            },
            "title": "Unsafe variable evaluation in email templates",
            "workarounds": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Limit backend access to trusted users, do not use user-controlled variables in the email template subjects."
                        }
                    ],
                    "value": "Limit backend access to trusted users, do not use user-controlled variables in the email template subjects."
                }
            ],
            "x_generator": {
                "engine": "Vulnogram 0.5.0"
            }
        }
    }
}